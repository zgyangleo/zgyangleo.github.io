
相似增加到24亿索引方案调整

- 索引排序方案1：分别在最近的4亿和此前的20亿中查询，然后分别取各种的top@K（K>100），合并后，用各自的分数进行排序，再取前200进行重排。这种方式存在的问题：由于设计的初始排序分数并不能很准确地反映视频之间的相似度，使得原本在小索引里面查询到的很相关的视频被在合并过程中排挤出去，而大索引里不相关的视频在合并过程中被纳入进来，从而使得索引量增加20亿后，视频查重的召回并没有显著的提升。该方案上线后一天后，发现召回并没有我们预期的增加很多召回。
- 索引排序方案2：将20亿数据的索引分片，比如分成4份，对于一个查询，分别到这4片索引里去查询以及到最近的4亿里查询，得到各自查询的排序结果，再对top@200的原始特征重排序，得到各自重排序的分数（重排序的分数能真实反映视频之间的相似度），然后对这5份重排序的结果利用重排序分数做一次合并排序。这种排序方式，理论上对最近的4亿上查重的召回不会造成任何影响，并且确实能增加很多召回。

搜狗识图pic.sogou.com技术方案总结

主要步骤总结：对int型SIFT特征采用ITQ编码成20 bit位哈希值，以及64位bit位哈希值，每幅图像选取最大的128个SIFT特征；
对于查询图像，提取SIFT特征，同样经过ITQ编码，假设查询图像经过编码后的特征为[q1, q2, q3 ...... q128]，取汉明距离为0，假设q1得到的候选文档为[id1, id1, id2, id4 ...... id(k+1)]，q2得到的候选文档为[id2, id3, id4 ...... id(k+1)]，......, q128得到的候选文档为[id3, id3, id4 ...... id(k+1)]，分别对这128个查询的结果，进行文档词频合并，然后按照词频从大到小排序；
对于上面排序的结果，再使用64 bit位哈希值进行重排，对重排的结果再使用几何校验进行再重排；